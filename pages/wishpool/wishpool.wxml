<!-- pages/wishpool/wishpool.wxml -->
<view class="wishpool-page">
    <!-- ÊêúÁ¥¢Ê†è -->
    <view class="search-section">
        <view class="search-bar" bindtap="goToSearch">
            <input class="search-input" placeholder="ÊêúÁ¥¢ÊÑøÊúõ..." value="{{searchValue}}" disabled />
            <view class="search-icon">üîç</view>
        </view>
    </view>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <view class="main-content">
        <!-- ‰æßËæπÊ†è -->
        <view class="sidebar-section">
            <t-side-bar value="{{contentSidebar}}" bind:change="onContentSideBarChange" class="category-sidebar">
                <t-side-bar-item wx:for="{{categoryList}}" wx:key="value" label="{{item.label}}" value="{{item.value}}" />
            </t-side-bar>
        </view>

        <!-- ÂÜÖÂÆπÂå∫Âüü -->
        <view class="content-area">
            <!-- ÂàÜÁ±ªÊ†áÈ¢ò -->
            <view class="category-header">
                <text class="category-title">{{currentCategoryLabel}}ÊÑøÊúõ</text>
                <text class="wish-count">({{wishList.length}}‰∏™)</text>
            </view>

            <!-- ÊÑøÊúõÂàóË°® -->
            <view class="wish-list">
                <view class="wish-card" 
                      wx:for="{{wishList}}" 
                      wx:key="id" 
                      data-id="{{item.id}}" 
                      bindtap="goToDetail">
                    
                    <!-- Á¨¨‰∏ÄË°åÔºöÊÑøÊúõÊ†áÈ¢ò -->
                    <view class="wish-title">{{item.title}}</view>
                    
                    <!-- Á¨¨‰∫åË°åÔºöÁî®Êà∑‰ø°ÊÅØÂíåÂèëÂ∏ÉÊó∂Èó¥ -->
                    <view class="wish-meta">
                        <view class="user-info">
                            <image class="user-avatar" src="{{item.user.avatar}}"></image>
                            <text class="user-name">{{item.user.nickname}}</text>
                        </view>
                        <text class="create-time">{{item.createTime}}</text>
                    </view>
                    
                    <!-- Á¨¨‰∏âË°åÔºöÊÑøÊúõÂõæÁâáÔºàÂ¶ÇÊûúÊúâÔºâ -->
                    <view class="wish-image-section" wx:if="{{item.image}}">
                        <image class="wish-image" 
                               src="{{item.image}}" 
                               mode="aspectFill"
                               data-index="{{index}}"
                               binderror="onImageError"
                               lazy-load="true"></image>
                    </view>
                    
                    <!-- ÊÑøÊúõÊèèËø∞ -->
                    <view class="wish-description" wx:if="{{item.description}}">
                        {{item.description}}
                    </view>
                    
                    <!-- Â∫ïÈÉ®Ôºö‰ª∑Ê†ºÂíå‰∫§ÊòìÊñπÂºè -->
                    <view class="wish-footer">
                        <view class="wish-tags">
                            <view class="category-tag">{{item.tag}}</view>
                            <view class="transaction-type {{item.transactionType}}">
                                {{item.transactionType === 'cash' ? 'Áé∞Èáë' : item.transactionType === 'swap' ? 'Êç¢Áâ©' : 'ÂùáÂèØ'}}
                            </view>
                        </view>
                        <view class="price-section">
                            <!-- Áé∞Èáë‰ª∑Ê†ºÊòæÁ§∫ -->
                            <view class="price-display" wx:if="{{item.priceDisplay}}">
                                {{item.priceDisplay}}
                            </view>
                            <!-- Êç¢Áâ©ÊòæÁ§∫ -->
                            <view class="swap-display" wx:if="{{item.transactionType === 'swap' || item.transactionType === 'both'}}">
                                Êç¢Áâ©
                            </view>
                        </view>
                    </view>
                </view>

                <!-- Á©∫Áä∂ÊÄÅ -->
                <view class="empty-state" wx:if="{{wishList.length === 0 && !isLoading}}">
                    <view class="empty-icon">‚≠ê</view>
                    <view class="empty-text">ËØ•ÂàÜÁ±ªÊöÇÊó†ÊÑøÊúõ</view>
                    <view class="empty-desc">ÂèëÂ∏É‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™ÊÑøÊúõÂêß</view>
                </view>

                <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
                <view class="loading-state" wx:if="{{isLoading}}">
                    <view class="loading-text">Âä†ËΩΩ‰∏≠...</view>
                </view>
            </view>
        </view>
    </view>
</view>