<!-- pages/wishpool/wishpool.wxml -->
<view class="wishpool-page">
    <!-- ÊêúÁ¥¢Ê†è -->
    <view class="search-section">
        <view class="search-bar" bindtap="goToSearch">
            <input class="search-input" placeholder="ÊêúÁ¥¢ÊÑøÊúõ..." value="{{searchValue}}" disabled />
            <view class="search-icon">üîç</view>
        </view>
    </view>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <view class="main-content">
        <!-- ‰æßËæπÊ†è -->
        <view class="sidebar-section">
            <t-side-bar value="{{contentSidebar}}" bind:change="onContentSideBarChange" class="category-sidebar">
                <t-side-bar-item wx:for="{{categoryList}}" wx:key="value" label="{{item.label}}" value="{{item.value}}" />
            </t-side-bar>
        </view>

        <!-- ÂÜÖÂÆπÂå∫Âüü -->
        <view class="content-area">
            <!-- ÂàÜÁ±ªÊ†áÈ¢ò -->
            <view class="category-header">
                <text class="category-title">{{currentCategoryLabel}}ÊÑøÊúõ</text>
                <text class="wish-count">({{wishList.length}}‰∏™)</text>
            </view>

            <!-- ÊÑøÊúõÂàóË°® -->
            <view class="wish-list">
                <view class="wish-card" 
                      wx:for="{{wishList}}" 
                      wx:key="id" 
                      data-id="{{item.id}}" 
                      data-index="{{index}}"
                      bindtap="goToDetail">
                    
                    <!-- Á¨¨‰∏ÄË°åÔºöÊÑøÊúõÊ†áÈ¢ò -->
                    <view class="wish-title">{{item.title}}</view>
                    
                    <!-- Á¨¨‰∫åË°åÔºöÊÑøÊúõÊèèËø∞ -->
                    <view class="wish-description" wx:if="{{item.description}}">
                        {{item.description}}
                    </view>
                    
                    <!-- Á¨¨‰∏âË°åÔºöÂ§öÂº†ÂõæÁâáÊòæÁ§∫Âå∫Âüü -->
                    <view class="wish-images-section" wx:if="{{item.displayImages && item.displayImages.length > 0}}">
                        <view class="images-grid {{item.displayImages.length === 1 ? 'single-grid' : ''}}">
                            <view class="image-item {{item.displayImages.length === 1 ? 'single' : ''}}" 
                                  wx:for="{{item.displayImages}}" 
                                  wx:key="index" 
                                  wx:for-item="image" 
                                  wx:for-index="imgIndex">
                                <image class="wish-image" 
                                       src="{{image.url}}" 
                                       mode="aspectFill"
                                       data-index="{{index}}"
                                       data-img-index="{{imgIndex}}"
                                       binderror="onImageError"
                                       lazy-load="true"></image>
                                <!-- ÂõæÁâáÊï∞ÈáèÊèêÁ§∫ -->
                                <view class="image-count" wx:if="{{image.isLast && item.totalImages > 3}}">
                                    <text class="count-icon">üñºÔ∏è</text>
                                    <text class="count-number">{{item.totalImages}}</text>
                                </view>
                            </view>
                        </view>
                    </view>
                    
                    <!-- Â∫ïÈÉ®Ôºö‰ª∑Ê†ºÂíå‰∫§ÊòìÊñπÂºè -->
                    <view class="wish-footer">
                        <view class="wish-tags">
                            <!-- Ëá™ÂÆö‰πâÊ†áÁ≠æÂå∫Âüü -->
                            <view class="custom-tags" wx:if="{{item.customTags && item.customTags.length > 0}}">
                                <view class="custom-tag" wx:for="{{item.customTags}}" wx:key="*this">
                                    {{item}}
                                </view>
                            </view>
                        </view>
                        <view class="price-section">
                            <!-- Áé∞Èáë‰ª∑Ê†ºÊòæÁ§∫ -->
                            <view class="price-display" wx:if="{{item.priceDisplay}}">
                                {{item.priceDisplay}}
                            </view>
                            <!-- Êç¢Áâ©ÊòæÁ§∫ -->
                            <view class="swap-display" wx:if="{{item.transactionType === 'swap' || item.transactionType === 'both'}}">
                                Êç¢Áâ©
                            </view>
                        </view>
                    </view>
                </view>

                <!-- Á©∫Áä∂ÊÄÅ -->
                <view class="empty-state" wx:if="{{wishList.length === 0 && !isLoading}}">
                    <view class="empty-icon">‚≠ê</view>
                    <view class="empty-text">ËØ•ÂàÜÁ±ªÊöÇÊó†ÊÑøÊúõ</view>
                    <view class="empty-desc">ÂèëÂ∏É‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™ÊÑøÊúõÂêß</view>
                </view>

                <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
                <view class="loading-state" wx:if="{{isLoading}}">
                    <view class="loading-text">Âä†ËΩΩ‰∏≠...</view>
                </view>
            </view>
        </view>
    </view>
</view>