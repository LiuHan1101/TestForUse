<!-- pages/wishpool/wishpool.wxml -->
<view class="wishpool-page">
    <!-- 搜索栏 -->
    <view class="search-section">
        <view class="search-bar" bindtap="goToSearch">
            <input class="search-input" placeholder="搜索愿望..." value="{{searchValue}}" disabled />
            <view class="search-icon">
                <image 
                    src="/images/search.png" 
                    style="width: 42rpx; height: 42rpx;"
                    mode="aspectFit"
                />
            </view>
        </view>
    </view>

  <!-- 主要内容区域 -->
  <view class="main-content">
        <!-- 左侧分类栏 -->
        <view class="sidebar-section">
            <scroll-view class="category-list" scroll-y enable-flex>
                <view wx:for="{{categoryList}}" 
                      wx:key="value" 
                      class="category-item {{contentSidebar === item.value ? 'active' : ''}} {{item.value === 'all' ? 'all' : ''}}"
                      data-value="{{item.value}}"
                      bindtap="switchCategory">
                    <text>{{item.label}}</text>
                </view>
            </scroll-view>
        </view>
        
        <!-- 右侧内容区域 -->
        <view class="content-area">
            <!-- 分类标题 -->
            <view class="category-header">
                <text class="category-title">{{currentCategoryLabel}}愿望</text>
                <text class="wish-count">({{wishList.length}}个)</text>
            </view>

            <!-- 愿望列表 -->
            <scroll-view class="wish-list" scroll-y>
                <view class="wish-card" 
                      wx:for="{{wishList}}" 
                      wx:key="id" 
                      data-index="{{index}}"
                      bindtap="goToDetail">
                    
                    <!-- 愿望标题 -->
                    <view class="wish-title">{{item.title}}</view>
                    
                    <!-- 愿望描述 -->
                    <view class="wish-description" wx:if="{{item.description}}">
                        {{item.description}}
                    </view>
                    
                    <!-- 图片显示 -->
                    <view class="wish-images-section" wx:if="{{item.displayImages && item.displayImages.length > 0}}">
                        <view class="images-grid {{item.displayImages.length === 1 ? 'single-grid' : ''}}">
                            <view class="image-item {{item.displayImages.length === 1 ? 'single' : ''}}" 
                                  wx:for="{{item.displayImages}}" 
                                  wx:key="index"
                                  wx:for-item="img"
                                  wx:for-index="imgIndex">
                                <image class="wish-image" 
                                       src="{{img.url}}" 
                                       mode="aspectFill"
                                       binderror="onImageError"
                                       data-index="{{index}}"
                                       data-img-index="{{imgIndex}}"
                                       lazy-load="true"></image>
                                <view class="image-count" wx:if="{{img.isLast && item.totalImages > 3}}">
                                    <text>{{item.totalImages}}</text>
                                </view>
                            </view>
                        </view>
                    </view>
                    
                    <!-- 底部信息 -->
                    <view class="wish-footer">
                        <view class="wish-tags">
                            <view class="custom-tags" wx:if="{{item.customTags && item.customTags.length > 0}}">
                                <view class="custom-tag" wx:for="{{item.customTags}}" wx:key="*this">
                                    {{item}}
                                </view>
                            </view>
                        </view>
                        <view class="price-section">
                            <!-- 显示"现金" -->
                            <view class="swap-display" 
                                  wx:if="{{item.transactionType === 'cash'}}">
                                现金
                            </view>
                            
                            <!-- 显示"换物" -->
                            <view class="swap-display" 
                                  wx:if="{{item.transactionType === 'swap'}}">
                                换物
                            </view>
                            
                            <!-- 显示"均可" -->
                            <view class="swap-display" 
                                  wx:if="{{item.transactionType === 'both'}}">
                                均可
                            </view>
                        </view>
                    </view>
                </view>

                <!-- 空状态 -->
                <view class="empty-state" wx:if="{{wishList.length === 0 && !isLoading}}">
                    <view class="empty-icon">⭐</view>
                    <view class="empty-text">该分类暂无愿望</view>
                    <view class="empty-desc">发布你的第一个愿望吧</view>
                </view>

                <!-- 加载状态 -->
                <view class="loading-state" wx:if="{{isLoading}}">
                    <view class="loading-text">加载中...</view>
                </view>
            </scroll-view>
        </view>
    </view>
</view>